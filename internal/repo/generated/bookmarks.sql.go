// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: bookmarks.sql

package generated

import (
	"context"
	"database/sql"
)

const createBookmark = `-- name: CreateBookmark :one
insert into bookmarks (title, url, description) values (?1, ?2, ?3) returning id
`

type CreateBookmarkParams struct {
	Title       string
	Url         string
	Description sql.NullString
}

func (q *Queries) CreateBookmark(ctx context.Context, arg CreateBookmarkParams) (int64, error) {
	row := q.db.QueryRowContext(ctx, createBookmark, arg.Title, arg.Url, arg.Description)
	var id int64
	err := row.Scan(&id)
	return id, err
}

const getBookmarks = `-- name: GetBookmarks :many
select id, title, url, description from bookmarks order by id desc
`

func (q *Queries) GetBookmarks(ctx context.Context) ([]Bookmark, error) {
	rows, err := q.db.QueryContext(ctx, getBookmarks)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Bookmark
	for rows.Next() {
		var i Bookmark
		if err := rows.Scan(
			&i.ID,
			&i.Title,
			&i.Url,
			&i.Description,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getBookmarksByTag = `-- name: GetBookmarksByTag :many
select b.id, b.title, b.url, b.description
from bookmarks b
inner join bookmarks_tags bt on b.id = bt.bookmark_id
inner join tags t on bt.tag_id = t.id
where t.tag_name = ?1
order by b.id desc
`

func (q *Queries) GetBookmarksByTag(ctx context.Context, tag string) ([]Bookmark, error) {
	rows, err := q.db.QueryContext(ctx, getBookmarksByTag, tag)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Bookmark
	for rows.Next() {
		var i Bookmark
		if err := rows.Scan(
			&i.ID,
			&i.Title,
			&i.Url,
			&i.Description,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const insertBookmarkTagJunction = `-- name: InsertBookmarkTagJunction :exec
insert into bookmarks_tags (bookmark_id, tag_id) values (?1, ?2)
`

type InsertBookmarkTagJunctionParams struct {
	BookmarkID int64
	TagID      int64
}

func (q *Queries) InsertBookmarkTagJunction(ctx context.Context, arg InsertBookmarkTagJunctionParams) error {
	_, err := q.db.ExecContext(ctx, insertBookmarkTagJunction, arg.BookmarkID, arg.TagID)
	return err
}
